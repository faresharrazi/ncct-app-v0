<nav class="navbar navbar-light bg-white mb-4">
  <div class="container-fluid justify-content-center py-3">
    <!-- General Account Net Income Button -->
    <%= button_to general_account_path(1), method: :get, class: "btn btn-success btn-lg px-5", form_class: "d-inline" do %>
      <%= number_to_currency(@general_account.net_income, unit: "€") %>
    <% end %>

    <% if Account.exists? %>
      <!-- New Transaction Button -->
      <%= button_to "New Transaction", new_transaction_path, method: :get, 
                    class: "btn btn-primary btn-lg ms-3 px-5", 
                    role: "button" %>
    <% end %>
  </div>
</nav>

<!-- Aligned Progress Bars -->
<div class="my-4">
  <% @accounts.each_with_index do |account, index| %>
    <% remaining_percentage = ((account.balance - account.transactions.sum(&:amount)) / account.balance * 100).round(2) %>
    <% progress_bar_class = 
      if remaining_percentage > 50
        "bg-success" # Light green
      elsif remaining_percentage >= 20
        "bg-warning" # Light orange
      else
        "bg-danger" # Light red
      end %>

    <div class="d-flex align-items-center mb-3">
      <!-- Progress Bar with Fixed Container -->
      <div class="progress flex-grow-1" style="height: 30px; width: 100%; background-color: #e9ecef;">
        <div class="progress-bar <%= progress_bar_class %>" 
             role="progressbar" 
             aria-label="<%= account.title %>" 
             aria-valuenow="<%= account.balance - account.transactions.sum(&:amount) %>" 
             aria-valuemin="0" 
             aria-valuemax="<%= account.balance %>" 
             style="width: <%= remaining_percentage %>%;">
          <!-- Account Title and Balance Inside the Bar -->
          <%= link_to "#{account.title}: #{(account.balance - account.transactions.sum(&:amount)).round(2)}€", 
                      account_path(account), 
                      style: "text-decoration: none; color: white;" %>
        </div>
      </div>
    </div>
  <% end %>
</div>




<!-- Clickable Cards for Totals -->
<div class="row text-center my-4">
  <% if Account.exists? %>
    <!-- All Transactions Card -->
    <div class="col-md-4 mb-3">
      <%= link_to transactions_path, class: "card border-primary text-decoration-none" do %>
        <div class="card-body">
          <h5 class="card-title text-primary">All Transactions</h5>
          <p class="card-text text-dark">
            <%= number_to_currency(@transactions_total, unit: "€") %>
          </p>
        </div>
      <% end %>
    </div>

    <!-- Global Income Card -->
    <div class="col-md-4 mb-3">
      <%= link_to general_incomes_path, class: "card border-success text-decoration-none" do %>
        <div class="card-body">
          <h5 class="card-title text-success">Global Income</h5>
          <p class="card-text text-dark">
            <%= number_to_currency(@global_income_total, unit: "€") %>
          </p>
        </div>
      <% end %>
    </div>

    <!-- Global Expense Card -->
    <div class="col-md-4 mb-3">
      <%= link_to general_expenses_path, class: "card border-danger text-decoration-none" do %>
        <div class="card-body">
          <h5 class="card-title text-danger">Global Expense</h5>
          <p class="card-text text-dark">
            <%= number_to_currency(@global_expense_total, unit: "€") %>
          </p>
        </div>
      <% end %>
    </div>
  <% end %>
</div>
